<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Beyond the Case - Home</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: Arial, sans-serif; }
    body { display: flex; flex-direction: column; min-height: 100vh; margin: 0; }
    
    .topbar {
      height: 60px;
      background-color: #ecf0f1;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      padding: 0 20px;
      gap: 20px;
    }
    .dropdown-hover, .dropdown-click { position: relative; display: inline-block; }
    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      display: none;
      flex-direction: column;
      z-index: 10;
      min-width: 150px;
    }
    .dropdown-hover:hover .dropdown-menu,
    .dropdown-click:hover .dropdown-menu { display: flex; }
    .dropdown-menu button {
      padding: 10px;
      background-color: white;
      border: none;
      text-align: left;
      cursor: pointer;
      font-size: 14px;
    }
    .dropdown-menu button:hover { background-color: #f0f0f0; color: #3498db; }
    .dropdown-hover button, .dropdown-click button {
      background-color: #3498db;
      color: white;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
    }
    .nav-button {
      background-color: #3498db;
      color: white;
      border: none;
      padding: 11px 12px;
      cursor: pointer;
    }
    .content { padding: 20px; }
    .hero {
      background: url('img/test.jpg') center/cover no-repeat;
      height: 300px;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      text-shadow: 1px 1px 4px rgba(0,0,0,0.8);
      font-size: 28px;
      font-weight: bold;
      text-align: center;
    }
    .section { margin-top: 30px; }
    .section h2 { margin-bottom: 15px; text-align: center; }
    .categories { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }
    .category {
      width: 200px; background: white; border: 1px solid #ccc;
      padding: 10px; text-align: center; cursor: pointer;
    }
    .category img { width: 100%; height: auto; margin-bottom: 8px; }
    .products { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
    .product {
      width: 150px; border: 1px solid #ccc; padding: 8px;
      text-align: center; background-color: white; font-size: 14px;
    }
    .product img { width: 100%; height: auto; margin-bottom: 6px; }
    .about {
      background: #f9f9f9; padding: 20px; text-align: center;
      font-size: 15px; line-height: 1.5;
    }
  </style>
</head>
<body>

  <!-- Topbar -->
  <div class="topbar">
    <div style="margin-right:auto; display:flex; gap:10px;">
      <button class="nav-button" onclick="location.href='helpcenter.html'">Help Center</button>
      <button class="nav-button" onclick="location.href='aboutus.html'">About Us</button>
      <button class="nav-button">Contact Us</button>
      <button class="nav-button" onclick="location.href='shop.html'">Shop</button>
    </div>

     <button class="nav-button" onclick="location.href='importintercom.html'">Import Intercom</button>

    <button class="nav-button" onclick="location.href='importfirebase.html'">Import Firebase </button>

    <!-- Show Data Button -->
    <button class="nav-button" onclick="showUserData()">Show Data</button>

    <div class="dropdown-hover">
      <button>Intercom ▾</button>
      <div class="dropdown-menu">
        <button>Tour</button>
        <button>Tour 1</button>
        <button>Tour 2</button>
      </div>
    </div>

    <!-- Accounts dropdown (dynamic) -->
    <div class="dropdown-click">
      <button>Accounts ▾</button>
      <div class="dropdown-menu" id="accountMenu"></div>
    </div>
  </div>

  <div class="content">
    <div class="hero">
      Beyond the Case – Your Phone, Your Style, Your Tech
    </div>

    <div class="section">
      <h2>Shop by Category</h2>
      <div class="categories">
        <div class="category"><img src="img/test.jpg" alt="Smartphones">Smartphones</div>
        <div class="category"><img src="img/test.jpg" alt="Phone Cases">Phone Cases</div>
        <div class="category"><img src="img/test.jpg" alt="Chargers & Accessories">Chargers & Accessories</div>
      </div>
    </div>

    <div class="section">
      <h2>Best Sellers</h2>
      <div class="products">
        <div class="product"><img src="img/test.jpg" alt="iPhone 15 Pro"> iPhone 15 Pro</div>
        <div class="product"><img src="img/test.jpg" alt="MagSafe Charger"> MagSafe Charger</div>
        <div class="product"><img src="img/test.jpg" alt="AirPods Pro"> AirPods Pro</div>
      </div>
    </div>

    <div class="section about">
      <h2>About Beyond the Case</h2>
      <p>Beyond the Case is your go-to destination for premium smartphones and must-have accessories. 
         Whether you're upgrading to the latest model or personalizing your device, 
         we offer a curated selection that blends technology with style. 
         From sleek phone cases to fast chargers, we've got everything you need to keep your tech game strong.</p>
    </div>
  </div>

  <script>
    const accountMenu = document.getElementById("accountMenu");
    const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";

    function renderAccountMenu() {
      accountMenu.innerHTML = "";
      if (isLoggedIn) {
        const profileBtn = document.createElement("button");
        profileBtn.textContent = "Profile";
        profileBtn.onclick = () => location.href = "profile.html";

        const logoutBtn = document.createElement("button");
        logoutBtn.textContent = "Logout";
        logoutBtn.onclick = () => {
          localStorage.clear();
          location.reload();
        };

        accountMenu.appendChild(profileBtn);
        accountMenu.appendChild(logoutBtn);
      } else {
        const signInBtn = document.createElement("button");
        signInBtn.textContent = "Sign In";
        signInBtn.onclick = () => location.href = "login.html";

        const registerBtn = document.createElement("button");
        registerBtn.textContent = "Register";
        registerBtn.onclick = () => location.href = "register.html";

        accountMenu.appendChild(signInBtn);
        accountMenu.appendChild(registerBtn);
      }
    }

    // Show Data Button logic
    function showUserData() {
      if (isLoggedIn) {
        const isLoggedInVal = localStorage.getItem("isLoggedIn") || "false";
        const userId = localStorage.getItem("userId") || "N/A";
        const userName = localStorage.getItem("userName") || "Unknown User";
        const userEmail = localStorage.getItem("userEmail") || "No email saved";
        const currentCredit = localStorage.getItem("currentCredit") || "0";
        const dateLastActive = localStorage.getItem("dateLastActive") || "N/A";
        const dateOfBirth = localStorage.getItem("dateOfBirth") || "N/A";
        const dateRegistered = localStorage.getItem("dateRegistered") || "N/A";
        const dateWhenMembershipStarted = localStorage.getItem("dateWhenMembershipStarted") || "N/A";
        const gender = localStorage.getItem("gender") || "N/A";
        const memberActivityStatus = localStorage.getItem("memberActivityStatus") || "N/A";
        const memberPassword = localStorage.getItem("memberPassword") || "N/A";
        const membershipStatus = localStorage.getItem("membershipStatus") || "N/A";
        const membershipTier = localStorage.getItem("membershipTier") || "N/A";
        const mobileNumber = localStorage.getItem("mobileNumber") || "N/A";
        const raceRecode = localStorage.getItem("raceRecode") || "N/A";

        alert(
          `User Data:\n\n` +
          `Is Logged In: ${isLoggedInVal}\n` +
          `User ID: ${userId}\n` +
          `Name: ${userName}\n` +
          `Email: ${userEmail}\n` +
          `Credits: ${currentCredit}\n` +
          `Date Last Active: ${dateLastActive}\n` +
          `Date of Birth: ${dateOfBirth}\n` +
          `Date Registered: ${dateRegistered}\n` +
          `Membership Start: ${dateWhenMembershipStarted}\n` +
          `Gender: ${gender}\n` +
          `Activity Status: ${memberActivityStatus}\n` +
          `Password: ${memberPassword}\n` +
          `Membership Status: ${membershipStatus}\n` +
          `Membership Tier: ${membershipTier}\n` +
          `Mobile Number: ${mobileNumber}\n` +
          `Race Recode: ${raceRecode}`
        );
      } else {
        alert("Not logged in");
      }
    }

    renderAccountMenu();
  </script>

  <!-- Intercom Messenger Embed -->
  <script>
    window.intercomSettings = {
      app_id: "lu3dtr42"
    };

    const isUserLoggedIn = localStorage.getItem("isLoggedIn") === "true";

      if (isUserLoggedIn) {

        const dateLastActiveStr = localStorage.getItem("dateLastActive");
        const today = new Date(); // today’s date

        let daysInactive = "N/A";
        let memTier = "N/A";
        let activityStatus = "ACTIVE";

        let age = "N/A";
        const dobStr = localStorage.getItem("dateOfBirth");
        if (dobStr) {
          const dob = new Date(dobStr);
          age = today.getFullYear() - dob.getFullYear();
          const m = today.getMonth() - dob.getMonth();
          if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
            age--; // subtract 1 if birthday hasn’t happened yet this year
          }
        }

        if (dateLastActiveStr) {
          const lastActive = new Date(dateLastActiveStr);
          const diffTime = today.getTime() - lastActive.getTime();
          daysInactive = Math.floor(diffTime / (1000 * 60 * 60 * 24));

          // classify memTier
          if (daysInactive >= 1 && daysInactive <= 30) {
            memTier = "P1M";
          } else if (daysInactive >= 31 && daysInactive <= 90) {
            memTier = "P3M";
          } else if (daysInactive >= 91 && daysInactive <= 180) {
            memTier = "P6M";
          } else if (daysInactive >= 181 && daysInactive <= 360) {
            memTier = "P12M";
          } else if (daysInactive >= 361) {
            memTier = "P12MI";
          }

          if (daysInactive >= 91) {
            activityStatus = "INACTIVE";
          } else {
            activityStatus = "ACTIVE";
          }

        }
        
        window.intercomSettings = {
          app_id: "lu3dtr42",
          user_id: localStorage.getItem("userId") || undefined,
          name: localStorage.getItem("userName") || undefined,
          email: localStorage.getItem("userEmail") || undefined,
          created_at: Math.floor(new Date(localStorage.getItem("dateRegistered") || Date.now()).getTime() / 1000),

          
          credit: localStorage.getItem("currentCredit") || "0",
          lastactivity: localStorage.getItem("dateLastActive") || "N/A",
          birthday: localStorage.getItem("dateOfBirth") || "N/A",
          registerdate: localStorage.getItem("dateRegistered") || "N/A",
          dateMembershipStarted: localStorage.getItem("dateWhenMembershipStarted") || "N/A",
          genderr: localStorage.getItem("gender") || "N/A",
          memStatus: localStorage.getItem("membershipStatus") || "N/A",
          number: localStorage.getItem("mobileNumber") || "N/A",
          race: localStorage.getItem("raceRecode") || "N/A",

          
          daysInactive: daysInactive,
          memTier: memTier,
          ActivityStatus: activityStatus,
          age:age
        };
      }

    (function(){var w=window;var ic=w.Intercom;
      if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}
      else {var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};
        w.Intercom=i;function l(){var s=d.createElement('script');
        s.type='text/javascript';s.async=true;
        s.src='https://widget.intercom.io/widget/lu3dtr42';
        var x=d.getElementsByTagName('script')[0];
        x.parentNode.insertBefore(s,x);}
        if(document.readyState==='complete'){l();}
        else if(w.attachEvent){w.attachEvent('onload',l);}
        else {w.addEventListener('load',l,false);}
      }
    })();
  </script>

</body>
</html>
